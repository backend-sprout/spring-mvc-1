동시 요청 - 멀티 쓰레드  
=========================   

# 개요 
  
[#](#)    
 
클라이언트에서 서버(WAS)로 요청을 보내면  
클라이언트와 서버(WAS)는 `TCP/IP 커넥션 연결`이 된다. (3Way Hand Shake)      
     
이후, 서버(WAS)는 `Servlet`을 통해 결과값을 얻고 이를 클라이언트에 반환해준다.        
그런데 한 가지 의문점이 `Servlet`에 대해서 우리는 단순히 정의만 해주었는데      
**`누가` Servlet을 객체로 만들고 이를 호출하여 사용하는 것일까? 🤔**     

이에 대한 해답으로 **쓰레드**라고 말할 수 있다.  
     
# 쓰레드        
실행 중인 프로그램을 우리는 프로세스라고 말을 한다.              
하나의 프로세스는 여러 작은 단위의 쓰레드를 가질 수 있다.            
      
쓰레드는, 애플리케이션 코드를 하나하나 순차적으로 실행하는 역할을 하고 있다.       
가장 적절한 비유로 우리가 기본적으로 사용하는 `main()` 메서드도 `Main 쓰레드`에 의해 실행된다.         
이말은 곧, 쓰레드가 없다면 자바 애플리케이션은 수행이 불가능하다는 것을 의미한다.     
     
**쓰레드는 한번에 하나의 코드 라인만을 수행한다.**      
그렇기에 **동시에 여러 요청이 온다면 쓰레드를 추가로 생성해줘야 한다.**        

## 단일 요청
   
[#](#)     
  
쓰레드가 1개만 있다고 가정을 한다.   
클라이언트에서 요청이 오면, WAS 에서는 쓰레드 한 개를 할당을 해서 요청을 처리하도록 한다.   
물론, 요청을 처리한다는 말은 Servlet 을 구동시켜 클라이언트에게 알맞은 응답을 주기 위해 애플리케이션 로직을 실행하는 것이다.    


## 다중 요청  
  
[#](#)  
  
쓰레드는 1개인데 여러 요청이 왔다고 가정한다.        
하나의 쓰레드는 하나의 요청만 처리할 수 있기 때문에 나머지 한 개의 요청은 대기가 된다.       
        
**그런데 만약,** 로직에 문제가 있어 응답 처리 시간이 지연이 된다면        
나머지 요청은 무기한 대기상태에 빠지게 되고    
**timeout 마저 지나면** 2개의 요청 모두 연결이 끊겨 응답이 실패하게 된다.         







